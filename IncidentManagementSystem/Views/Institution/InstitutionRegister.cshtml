@model IncidentManagementSystem.Model.InstNameDto@*@{        ViewBag.Title = "InstitutionRegister";    }*@<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" /><script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script><div class="container-fluid reg-inst">    <div class="row  ">        @using (Html.BeginForm("InstitutionRegister", "Institution", FormMethod.Post, new { enctype = "multipart/form-data", role = "form", id = "ins_form" }))        {<div class="row ins-row">    <div class="col-lg-10">        <div class="container-fluid justify-content-center  container-inst-style ">            @Html.AntiForgeryToken()            @Html.ValidationSummary("", new { @class = "text-danger" })            <div class="row">                <div class="col-lg-4 inst-row-form">                    @Html.LabelFor(m => m.InstitutionName, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-lg-12">                        @Html.TextBoxFor(m => m.InstitutionName, new { @class = "form-control b-inst" })                    </div>                </div>                <div class="col-lg-4 inst-row-form">                    @Html.LabelFor(m => m.Country, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-lg-12">                        @Html.TextBoxFor(m => m.Country, new { @class = "form-control b-inst" })                    </div>                </div>                <div class="col-lg-4 inst-row-form">                    @Html.LabelFor(m => m.State, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-lg-12">                        @Html.TextBoxFor(m => m.State, new { @class = "form-control b-inst" })                    </div>                </div>            </div>            <div class="row">                <div class="col-lg-4  inst-row-form">                    @Html.LabelFor(m => m.Address, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-md-12">                        @Html.TextBoxFor(m => m.Address, new { @class = "form-control b-inst" })                    </div>                </div>                <div class="col-lg-4  inst-row-form">                    @Html.LabelFor(m => m.ZipCode, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-md-12">                        @Html.TextBoxFor(m => m.ZipCode, new { @class = "form-control b-inst" })                    </div>                </div>                <div class="col-lg-4  inst-row-form">                    @Html.LabelFor(m => m.Email, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-md-12">                        @Html.TextBoxFor(m => m.Email, new { @class = "form-control b-inst" })                    </div>                </div>            </div>            <div class="row">                <div class="col-lg-4  inst-row-form">                    @Html.LabelFor(m => m.ContactNumber, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-md-12">                        @Html.TextBoxFor(m => m.ContactNumber, new { @class = "form-control b-inst" })                    </div>                </div>                <div class="col-lg-4  inst-row-form">                    @Html.LabelFor(m => m.ContactPersonAdmin, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-md-12">                        @Html.TextBoxFor(m => m.ContactPersonAdmin, new { @class = "form-control b-inst" })                    </div>                </div>                <div class="col-lg-4  inst-row-form">                    @Html.LabelFor(m => m.ContactPersonTechnical, new { @class = "col-md-4 col-form-label l-inst" })                    <div class="col-md-12">                        @Html.TextBoxFor(m => m.ContactPersonTechnical, new { @class = "form-control b-inst" })                    </div>                </div>                @*<div class="col-lg-4  inst-row-form">                        <label class="col-md-4 col-form-label l-inst">Service</label>                        <div class="col-md-12">                            <select class="form-control b-inst" name="ServiceId" id="ServiceId">                                <option value="">--Select Services--</option>                                @foreach (var Service in ViewBag.services)                                {                                    <option value="@Service.Value">@Service.Text</option>                                }                            </select>                        </div>                    </div>*@                <div class="col-lg-4  inst-row-form">                    <label class="col-md-4 col-form-label l-inst">Service</label>                    <div class="col-md-12">                        <select class="form-control b-inst" name="ServiceId" id="ServiceId" multiple>                            <option value="">--Select Services--</option>                            @foreach (var Service in ViewBag.services)                            {            <option value="@Service.Value" class="selectService">@Service.Text</option>        }                        </select>                    </div>                    <div class="col-md-12">                        <div id="selectedServicesLabel">                            @*<div>                                    <textarea class="form-control" id="selectedServices" name="selectedServices"></textarea>                                </div>*@                        </div>                    </div>                </div>            </div>            <div class="row  form-group" style="margin-top:10px">                <div class="col-md-2">                    <input type="submit" value="Register" class="btn btn-success btn-lg" id="submit" />                </div>                <div class="col-md-2">                    @*<input type="button" value="Clear Form" onclick="window.location.reload();" />*@                    <input type="reset" value="Clear" class="btn btn-secondary btn-lg " onclick="clearForm();" /> @*scrypt method*@                </div>            </div>        </div>    </div>    <div class="col-lg-2 file-upload">        <div class="row">            <div class="col-lg-12 file-upload justify-content-center">                <div class="inst-img" style="background-color:lightgray;">                    <a href="#" id="imageAnchor">                        <img id="preview" src="~/Image/photo-album-regular-24.png" class="card-img-top" alt="Preview" />                    </a>                </div>            </div>            <div class="row upload">                <div class="col-lg-12">                    @*<label for="uploadReportFile">Select file to upload:</label><br />*@                    <input type="file" name="file" id="file" accept="image/*" onchange="previewImage(event)" class="form-control" style="width: 105px" required />                </div>            </div>            @*<div class="row justify-content-start buttom-inst">                    <div class="col-lg-4">                        <input type="submit" value="Upload" class="btn btn-primary" />                    </div>                </div>*@        </div>    </div></div>}    </div></div><div class="modal fade" id="modalTaskComplete" tabindex="-1" role="dialog" aria-labelledby="modalTaskCompleteLabel" aria-hidden="true">    <div class="modal-dialog modal-dialog-centered" role="document">        <div class="modal-content">            <div class="modal-header bg-primary text-white">                <h5 class="modal-title" id="modalTaskCompleteLabel">Member Branch Creation Status</h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>            </div>            <div class="modal-body text-center">                <h4 class="@((string)ViewBag.TaskStatus == "00" ? "text-success" : "text-danger")">@ViewBag.TaskMessage</h4>            </div>            <div class="modal-footer">                @if ((string)ViewBag.TaskStatus == "00")                {                    <button type="button" class="btn btn-success" data-dismiss="modal" onclick="location.href='@Url.Action("Search", "Institution")'">Okay</button>                }                else                {                    <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="location.href='@Url.Action("InstitutionRegister", "Institution")'">Okay</button>                }            </div>        </div>    </div></div>@section scripts{    <script>        let serviceList = [];        $(document).ready(function () {            $('.selectService').click(function (e) {                debugger;                e.preventDefault();                var serviceName = $(this).text();                var serviceValue = $(this).val();                //var selectedServices = $('#selectedServices');                /* selectedServices.val(selectedServices.val() + serviceName + ',');*/                // Check if serviceName is already in selectedServices                //if (selectedServices.val().indexOf(serviceName) === -1) {                //    selectedServices.val(selectedServices.val() + serviceName + ',');                //} else {                //    // Optionally, you can show a message or handle the case where it's already selected                //    console.log(serviceName + ' is already selected.');                //}                //// Check if the button with the same serviceName already exists                if ($('#selectedServicesLabel').find('button:contains("' + serviceName + '")').length === 0) {                    // Create a new button element with cross icon                    var button = $('<button>').text(serviceName)                        .addClass('btn btn-primary mr-2 mb-2')                        .attr('type', 'button').css('margin-left', '10px')                        .append($('<span>').addClass('ml-2').css({ 'color': 'red', 'margin-left': '5px' }).html('&times;'));                    serviceList.push(serviceValue);                    // Append the button to the 'selectedServicesLabel' div                    $('#selectedServicesLabel').append(button);                    console.log(serviceList);                    // Add click event to remove the button                    button.click(function (e) {                        debugger;                        const index = serviceList.indexOf(serviceValue);                        if (index > -1) { // only splice array when item is found                            serviceList.splice(index, 1); // 2nd parameter means remove one item only                        }                        console.log(serviceList);                        //serviceList.                        $(this).remove();  // Remove the button itself when clicked                    });                } else {                    // Handle the case where the button already exists                    console.log('Button for "' + serviceName + '" already selected.');                }            });            $('#submit').click(function () {                debugger;                var services = serviceList.join(',');                $("<input>").attr({                    name: "ServiceIdList",                    id: "hiddenId",                    type: "hidden",                    value: services                }).appendTo("#ins_form");                //$('#ins_form').append('<input type="hidden" name="fieldname" value="" />');            });        });        // Show the image preview        document.addEventListener("DOMContentLoaded", function () {            var preview = document.getElementById('preview');            var file = document.getElementById('file');            imageAnchor.addEventListener('click', function () {                file.click();            });        });        function previewImage(event) {            var input = event.target;            var reader = new FileReader();            reader.onload = function () {                var imgElement = document.getElementById('preview');                imgElement.src = reader.result;                imgElement.style.display = 'block'; // Show the image preview            }            reader.readAsDataURL(input.files[0]);        }        function clearForm() {            // Reset the form            document.getElementById("ins-form").reset();            // Reset the file input            document.getElementById("imageUpload").value = "";            // Reset the image preview            document.getElementById("preview").src = "#";            document.getElementById("preview").style.display = "block";        }        $(document).ready(function () {                debugger;          var status= '@ViewBag.TaskStatus';           if (status != null && status != '')           {             $("#modalTaskComplete").modal('show');           }        });    </script>}